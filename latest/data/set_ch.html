<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html; charset=windows-1252" http-equiv="content-type">
    <title>SSLAC16</title>
  </head>
  <body onload="gen_table()" bgcolor="#00BEBE">
    <h1>
      <div id="hostname"></div>
    </h1>
    <h5><div id="ver"></div></h5>
    <h3>Channels SetUp</h3>
    <form action="/" method="get"><input value="&lt;-Back" type="submit"> <button
        formmethod="get" formaction="/cur_ch.html" type="submit">View Channels
        status</button> </form>
    <form> <br>
      Channels group :
      <select id="g1" name="group" onchange="gen_table()">
        <option selected="selected">0-7</option>
        <option>8-15</option>
      </select>
      Mode :
      <select id="1" name="mode" onchange="gen_table()">
        <option>Night/Min</option>
        <option selected="selected"> Day/Max</option>
      </select>
    </form>
    <form id="id01"></form>
    <form action="/"> <br>
      <input value="Save" onclick="sv()" type="button"> <button formmethod="get"
        formaction="/set_time.html" type="submit">Time SetUp</button> <button formmethod="get"
        formaction="/set_i2c.html" type="submit">I2C SetUp</button> <button formmethod="get"
        formaction="/set_sched.html" type="submit">Channels Schedule</button> <button
        formmethod="get" formaction="/set_wifi.html" type="submit">WiFi SetUp</button>
    </form>
    <script src="sslac.js">  </script>
    <script>
      document.getElementById('ver').innerHTML = get_version();
    get_info(); 
      var _url='';
      
      function inv(s,_ch){
        
        if (document.getElementById(s+_ch).checked) {
          set_rest('ch='+_ch+'&'+s+'='+1);
        } else
          set_rest('ch='+_ch+'&'+s+'='+0);
        
      }
      function gen_table(){
        var out='';
        var group=document.getElementById('g1').value;
        var mode = document.getElementById('1').value;
        var isMode=1;
        var t;
        var arr;
        if (mode=='Night/Min') isMode=0; else isMode=1;
        if (isMode==0) t=0;else t=2;
        var a=0;
        var b=8;
        var ch;
          set_rest('isMode='+isMode);
          set_rest('isSetupCh=1');
          if (group=='0-7') set_rest('channelGroup=0'); else set_rest('channelGroup=1');
              arr=get_rest('ch');
        if (group=='8-15') {
           a=8;b=16;
        }
        out+='<table style="width: 512px" border="0"><tbody><tr>';
        out+='<td>ID</td><td>Description</td><td>Value<td>Mode</td><td>Is it Fan?</td></tr>';
        for (i=a;i<b;i++){
            if (i<10) ch=' '+i; else ch=i;
          out+='<tr><td>'+ch+')</td><td><input maxlength="16"  type="text" value="'+arr[i][5]+'" onchange="desc(\''+i+'\')" id=desc'+i+'></td>';
            out+='<td><input step="1" max="4095" min="0" oninput="r_f(\'r'+ch+'\',\'n'+ch+'\')" id="r'+ch+'"';
          
          
          out+='value="'+arr[i][t]+'" type="range"><input step="1" max="4095" min="0" id="n'+ch+'" onchange="r_f(\'n'+ch+'\',\'r'+ch+'\')"';
          out+='value="'+arr[i][t]+'" type="number"></td><td><input id="inv'+i+'" onchange="inv(\'inv\','+i+')" type="checkbox"';
            if (arr[i][3]==1) out+=' checked ';
          out+='>Inverted</td><td><input ';
            out+='id="fan'+i+'" onchange="inv(\'fan\','+i+')" type="checkbox"';
            if (arr[i][4]==99) out+=' checked ';
          out+='>Fan</td></tr>';
        }
        out+='</tbody>\
    </table>';
        out+='</form>';
        document.getElementById('id01').innerHTML = out;
      }
      
      function desc(i){
        val=document.getElementById('desc'+i).value;
        set_rest('ch='+i+'&desc='+val);
      }
      
      function r_f(ID_in,ID_out){
        var val=parseInt(document.getElementById(ID_in).value);
        document.getElementById(ID_out).value=val;
        var body= 'ch='+parseInt(ID_in.substr(1,2))+'&='+val;
        set_rest('ch='+parseInt(ID_in.substr(1,2))+'&='+val);
      }
      
function get_info(){
             var _arr=get_rest('info');
             if (_arr[1][17]==1) document.getElementById('hostname').innerHTML = _arr[1][15]+'(Slave)';
              if (_arr[1][16]==1) document.getElementById('hostname').innerHTML = _arr[1][15]+'(Master)';
              if ((_arr[1][16]==0) & (_arr[1][17]==0)) document.getElementById('hostname').innerHTML = _arr[1][15];
             
}      
</script>
  </body>
</html>
