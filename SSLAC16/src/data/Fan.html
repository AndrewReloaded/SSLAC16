<!DOCTYPE html><html><head></head><body onload=bodyLoad() style=background-color:#00bebe><div id=fan></div><br><div id=group></div><div id=ds18x20></div><form><input value=Save onclick=sv() type=button><input type=button onClick=home() value='Daily Schedule'><input type=button onClick="location.href='1SetUp.html'" value='Channels&Group setup'><input type=button onClick="location.href='EmLight.html'" value='Emergency light setup'><input type=button onClick="location.href='Fan.html'" value='Fan/Temperature setup' disabled><input type=button onClick="location.href='setuphw.html'" value=Setup&Upgrade><input value=Reboot \ onclick=sr() type=button></form></body><script src=sslac.js></script><script>set_rest("EmLight=0",_ip);var _tIndex=[];var _tMin=[];var _tMax=[];var _tValue=[];var ch=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];var _Sensor=[];var group;get_sensor();function groupLoad(){var b="<table style='width: 750px' border='1'>	  <caption>Group temperature alarm setup</caption>	  <tbody><tr><td>Group</td><td>T critical C</td><td>Decreasing step x/4095</td><td> Sensor name/T(C)</tr>";var a="</tbody></table>";var c="";group=get_rest("grN=all",_ip);for(i=0;i<8;i++){c+="<tr>";c+="<td>"+group[0][i];c+="<td><input onchange='setTemp(this)'min=15 max=100 id='tCri"+i+"' type='number'";c+="value="+group[2][i]+">";c+="<td><input step=1 oninput='setStep(this)' min=0 max=255 id='step"+i+"' type='number'";c+="value="+group[3][i]+">";c+="<td>";c+="<select onchange='setSensor(this)' id='gSensor"+i+"'>";c+="<option value=255 > Not use";for(j=0;j<_Sensor.length;j++){if(group[1][i]==_Sensor[j][8]){c+="<option selected value="+_Sensor[j][8]+">"+_Sensor[j][10]+"/"+_Sensor[j][9]/1000+"C"}else{c+="<option value="+_Sensor[j][8]+">"+_Sensor[j][10]+"/"+_Sensor[j][9]/1000+"C"}}c+="</select>";c+="</tr>"}document.getElementById("group").innerHTML=b+c+a}function bodyLoad(){set_rest("i2c=",_ip);var d="<table style='width: 750px' border='1'>	  <caption>Channels Fan type setup</caption>	  <tbody><tr><td>Channel name</td><td>T min C</td><td>T max C</td><td>RPM min %</td>	  <td> Sensor name/T(C)</tr>";var e="</tbody></table>";var a="";for(i=0;i<16;i++){var f=get_rest("chN="+i,_ip);ch[i]=f;if(ch[i][4][0]>15){a+="<tr>";var g=ch[i][6][0];_tIndex[i]=ch[i][4][0]-16;_tMax[i]=ch[i][1][0]%60;_tMin[i]=ch[i][1][0]/60;_tValue[i]=ch[i][0][0];a+="<td>"+g;a+="<td><input onchange='setTemp(this)'min=15 max=100 id='tMin"+i+"' type='number'>";a+="<td><input onchange='setTemp(this)'min=15 max=100 id='tMax"+i+"' type='number'>";a+="<td><input step=0.025 onfocus='setRPM(this)' onblur='unset()' oninput='setRPM(this)' min=0 max=100 id='tValue"+i+"' type='number'>";a+="<td>";a+="<select onchange='setSensor(this)' id='tSensor"+i+"'>";a+="<option value=255 > Not use";a+="</select>";a+="</tr>"}}document.getElementById("fan").innerHTML=d+a+e;for(i=0;i<16;i++){var k=document.getElementById("tMin"+i);if(k!=null){if(_tMin[i]<15){_tMin[i]=15}k.value=_tMin[i];if(_tMax[i]<_tMin[i]){_tMax[i]=50;var b=_tMin[i]*60+_tMax[i];set_rest("tpN="+i+"&0="+b,_ip)}document.getElementById("tMax"+i).value=_tMax[i];if(_tValue[i]<15){_tValue[i]=4095}document.getElementById("tValue"+i).value=Math.round(_tValue[i]*100/4095)}}for(i=0;i<parseInt(get_rest("temp=",_ip));i++){for(j=0;j<16;j++){var k=document.getElementById("tSensor"+j);if(k!=null){var c=document.createElement("option");c.text=_Sensor[i][10]+"/"+_Sensor[i][9]/1000+"C";c.value=_Sensor[i][8];var h=16+parseInt(c.value);if(h==ch[j][4][0]){c.selected=true}k.add(c)}}}groupLoad()}function setTemp(b){var c=parseInt(b.id.substring(4));if(b.id.substring(1,4)=="Min"){var a=b.value*60+parseInt(document.getElementById("tMax"+c).value);document.getElementById("tMax"+c).min=b.value;set_rest("tpN="+c+"&0="+a,_ip)}if(b.id.substring(1,4)=="Max"){var a=parseInt(b.value)+parseInt(document.getElementById("tMin"+c).value)*60;set_rest("tpN="+c+"&0="+a,_ip)}if(b.id.substring(1,4)=="Cri"){set_rest("grN="+c+"&temp="+b.value,_ip)}}function unset(){set_rest("playTime=255",_ip)}function setSensor(a){var b=parseInt(a.id.substring(7));if(a.id.substring(0,7)=="tSensor"){set_rest("typeN="+b+"&="+(16+parseInt(a.value)),_ip)}if(a.id.substring(0,7)=="gSensor"){set_rest("grN="+b+"&alarmIndex="+(parseInt(a.value)),_ip)}}function setRPM(c){var d=parseInt(c.id.substring(6));var b=parseInt(document.getElementById("tSensor"+d).value);var a=Math.round((c.value*4095)/100);var d=parseInt(c.id.substring(6));if(b==255){b=0}set_rest("playTime="+(16+b),_ip);set_rest("typeN="+d+"&="+(16+b),_ip);set_rest("chN="+d+"&0="+a,_ip)}function setStep(a){var b=parseInt(a.id.substring(4));console.log(a.id+";"+b+":"+a.value);set_rest("grN="+b+"&step="+a.value,_ip)}function get_sensor(){cSensor=get_rest("temp=",_ip);for(i=0;i<cSensor;i++){_Sensor[i]=get_rest("temp="+i,_ip)}};</script></html>